#!/usr/bin/env ruby

require 'rubygems'
require 'gli'
require 'datainsight_logging'

require_relative '../lib/recorders/todays_activity'
require_relative '../lib/datamapper_config'

include GLI

program_desc 'Stuff'

version 0.1

arg_name 'Enable development logging'
switch [:v, :dev]

desc 'Listen for messages'
command :run do |c|
  c.action do |global_options, options, args|
    env = global_options[:dev] ? :development : :production
    Datainsight::Logging.configure(:type => :recorder, :env => env)
    DataMapperConfig.configure
    Recorders::TodaysActivityRecorder.new.run
  end
end

exit GLI.run(ARGV)

